# –¢—É—Ä–Ω–∏—Ä–Ω—ã–π —Å–∞–π—Ç - PostgreSQL –≤–µ—Ä—Å–∏—è –¥–ª—è Spaceweb

## üì¶ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

–ü–æ–ª–Ω—ã–π –±—ç–∫–µ–Ω–¥ –Ω–∞ PHP –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Spaceweb.

### –§–∞–π–ª—ã API:
- `api/config.php` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `api/auth.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- `api/user-auth.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∫–∞–ø–∏—Ç–∞–Ω–æ–≤ –∫–æ–º–∞–Ω–¥
- `api/register.php` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –∏ –∏–≥—Ä–æ–∫–æ–≤
- `api/teams.php` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏
- `api/settings.php` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞
- `database_export.sql` - –î–∞–º–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ –¥–∞–Ω–Ω—ã–º–∏

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ Spaceweb

### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Spaceweb –ø–∞–Ω–µ–ª—å ‚Üí –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
2. –í—ã–±–µ—Ä–∏—Ç–µ –±–∞–∑—É `smirnovaul` (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é PostgreSQL –±–∞–∑—É)
3. –ù–∞–∂–º–∏—Ç–µ **"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" ‚Üí phpPgAdmin** –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH
4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `database_export.sql`

**–ß–µ—Ä–µ–∑ phpPgAdmin:**
- SQL ‚Üí –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `database_export.sql`
- –ù–∞–∂–º–∏—Ç–µ "–í—ã–ø–æ–ª–Ω–∏—Ç—å"

**–ß–µ—Ä–µ–∑ SSH:**
```bash
psql -h localhost -U smirnovaul -d smirnovaul -f database_export.sql
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ `api/config.php`
2. –ó–∞–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```php
define('DB_HOST', 'localhost');  // –ò–ª–∏ IP –∏–∑ –ø–∞–Ω–µ–ª–∏
define('DB_NAME', 'smirnovaul'); // –ò–º—è –≤–∞—à–µ–π –ë–î
define('DB_USER', 'smirnovaul'); // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î
define('DB_PASS', '–≤–∞—à_–ø–∞—Ä–æ–ª—å'); // –ü–∞—Ä–æ–ª—å –∏–∑ –ø–∞–Ω–µ–ª–∏ Spaceweb
define('DB_PORT', '5432');       // –ü–æ—Ä—Ç PostgreSQL
```

### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Spaceweb –ø–æ FTP –∏–ª–∏ —á–µ—Ä–µ–∑ –§–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–∞–ø–∫—É `api/` –≤ –∫–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞: `public_html/api/`
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª—ã:
   - –ü–∞–ø–∫–∏: **755**
   - PHP —Ñ–∞–π–ª—ã: **644**

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.ru/api/settings.php
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
```json
{
  "settings": {
    "registration_open": "true",
    "home_title": "League of Legends: Wild Rift",
    ...
  }
}
```

## üîê –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞

### –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:
- **–õ–æ–≥–∏–Ω:** `Xuna`
- **–ü–∞—Ä–æ–ª—å:** `Smirnova2468`

### –í—Ç–æ—Ä–æ–π –∞–¥–º–∏–Ω:
- **–õ–æ–≥–∏–Ω:** `Dante`
- **–ü–∞—Ä–æ–ª—å:** (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ë–î)

## üìã API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ:
- `GET /api/settings.php` - –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞
- `POST /api/register.php` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã/–∏–≥—Ä–æ–∫–∞
- `GET /api/teams.php?action=approved` - –°–ø–∏—Å–æ–∫ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

### –î–ª—è –∞–¥–º–∏–Ω–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç—Å—è X-Auth-Token):
- `POST /api/auth.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞
- `GET /api/teams.php?action=pending` - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
- `POST /api/teams.php` - –û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥
- `POST /api/settings.php` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –î–ª—è –∫–∞–ø–∏—Ç–∞–Ω–æ–≤ –∫–æ–º–∞–Ω–¥ (—Ç—Ä–µ–±—É–µ—Ç—Å—è X-User-Id):
- `POST /api/user-auth.php` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã
- `PUT /api/teams.php` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã

## üîß –û—Ç–ª–∏—á–∏—è –æ—Ç MySQL –≤–µ—Ä—Å–∏–∏

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å:
- **–ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã:** `$1, $2, $3` –≤–º–µ—Å—Ç–æ `?, ?, ?`
- **DSN:** `pgsql:` –≤–º–µ—Å—Ç–æ `mysql:`
- **–ü–æ—Ä—Ç:** 5432 –≤–º–µ—Å—Ç–æ 3306

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î:
- **–°—Ç–∞—Ç—É—Å—ã –∫–æ–º–∞–Ω–¥:** `'pending' | 'approved' | 'rejected'` –≤–º–µ—Å—Ç–æ `is_approved BOOLEAN`
- **SERIAL:** –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç ID –≤ PostgreSQL
- **TEXT[]:** –º–∞—Å—Å–∏–≤—ã –¥–ª—è —Ä–æ–ª–µ–π –∏–≥—Ä–æ–∫–æ–≤

### –ö–æ–º–∞–Ω–¥—ã:
- **UPSERT:** `ON CONFLICT DO UPDATE` –≤–º–µ—Å—Ç–æ `ON DUPLICATE KEY UPDATE`

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
2. **PHP –≤–µ—Ä—Å–∏—è:** –ú–∏–Ω–∏–º—É–º PHP 7.4 —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `pdo_pgsql`
3. **CORS:** –ó–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±—ã–º frontend
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è SHA-256

## üÜò –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ `config.php`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î

### –û—à–∏–±–∫–∞ "relation does not exist":
- –ë–∞–∑–∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `database_export.sql`

### CORS –æ—à–∏–±–∫–∏:
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools ‚Üí Network)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ PHP: `/var/log/php_errors.log`
2. –õ–æ–≥–∏ PostgreSQL: `/var/log/postgresql/`
3. –ü–∞–Ω–µ–ª—å Spaceweb ‚Üí –õ–æ–≥–∏

---

**–°–æ–∑–¥–∞–Ω–æ –¥–ª—è —Ç—É—Ä–Ω–∏—Ä–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã League of Legends: Wild Rift**
